sudo: required
os: osx
language: node_js
node_js: '7'
osx_image: xcode9.3
#env: DEVICE=11.3      

before_script:
  - brew cask install xquartz
  - "export DISPLAY=:5.0"
  - if [ "${TRAVIS_OS_NAME}" = "osx" ]; then ( sudo Xvfb :5 -ac -screen 0 1024x768x8; echo ok )& fi
  - sleep 3 # give xvfb some time to start
  - brew update
  - brew install libimobiledevice
  - brew install ideviceinstaller
  - brew install ios-webkit-debug-proxy
  - npm install -g ios-deploy
  
script:
#   - npm install
  - ./node_modules/.bin/appium-doctor --ios
  - ./node_modules/.bin/appium &
  - xcrun simctl
  - xcrun instruments -w "iPhone 5 (8.0 Simulator)"
  - sleep 20
  - npm run nightwatch-cucumber-travis-ios -- --tag iostest

